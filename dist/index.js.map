{"version":3,"file":"index.js","sources":["../src/helpers.js","../src/reactAgendaItem.js","../src/dragAndDropHelper.js","../src/reactAgenda.js","../src/reactAgendaCtrl.js","../src/Modal/Modal.js","../src/index.js"],"sourcesContent":["/*** Helper functions - they are decoupled because of testability */\nimport moment from 'moment'\n\n/**\n * @param {array} items\n * @param {number} indexFrom\n * @param {number} indexTo\n * @returns {array}\n */\nexport function swapArrayElements(items, indexFrom, indexTo) {\n  var item = items[indexTo];\n  items[indexTo] = items[indexFrom];\n  items[indexFrom] = item;\n  return items;\n}\n\n/**\n * @param {number} mousePos\n * @param {number} elementPos\n * @param {number} elementSize\n * @returns {boolean}\n\n\n */\n\n\n\n\nexport function isMouseBeyond(mousePos, elementPos, elementSize, moveInMiddle) {\n  var breakPoint;\n  if(moveInMiddle){\n    breakPoint = elementSize / 2; //break point is set to the middle line of element\n  }else{\n    breakPoint = 0\n  }\n  var mouseOverlap = mousePos - elementPos;\n  return mouseOverlap > breakPoint;\n}\n\n\nexport function getUnique(array){\n  var newAr = array.filter(function(val,ind) { return array.indexOf(val) == ind; })\n  return newAr\n}\nexport function getLast(array){\n  return array[array.length-1];\n}\n\nexport function getFirst(array){\n  return  array[0];\n}\n\nexport function guid () {\n  function s4() {\n    return Math.floor((1 + Math.random()) * 0x10000)\n      .toString(16)\n      .substring(1);\n  }\n  return s4() + s4() + '-' + s4() + '-' + s4() + '-' +\n    s4() + '-' + s4() + s4() + s4();\n}\n\n/********************************/\n/*  GENERATE ROWS OF CELLS     */\n/******************************/\n\n\nexport function mapItems(itemsArray, rowsPerHour, timezone) {\n  var itemsMap = {};\n\n  itemsArray = itemsArray.sort(function(a, b) {\n    return a.startDateTime - b.startDateTime;\n  });\n\n  itemsArray.forEach(function(item) {\n    if (!item.startDateTime) {\n      return false\n    }\n    var interval = (60 / rowsPerHour);\n    var offsetMinutes = item.startDateTime.getMinutes() % interval;\n    var start = moment(item.startDateTime).subtract(offsetMinutes, \"minutes\").toDate();\n    var end = moment(item.endDateTime);\n    var duration = moment.duration(end.diff(moment(item.startDateTime))); //moment.duration(end.diff(start));\n    item.duration = duration\n    var rows = Math.ceil(duration.asHours() / (interval / 60));\n\n    var cellRefs = [];\n    for (var i = 0; i < rows; i++) {\n      var ref = moment(start).add(i * interval, 'minutes');\n      // if(timezone) {\n      //     ref.tz(timezone);\n      // }\n      ref = ref.format('YYYY-MM-DDTHH:mm:00');\n      cellRefs.push(ref);\n    }\n\n    cellRefs.forEach(function(ref) {\n\n      var newItem = Object.keys(item).filter(key => !key.includes('classes')).reduce((obj, key) => {\n        obj[key] = item[key];\n        return obj;\n      }, {});\n\n      newItem.classes = itemsMap[ref]\n        ? (itemsMap[ref].classes + ' ' + item.classes)\n        : (item.classes || '');\n      newItem.cellRefs = [getFirst(cellRefs), getLast(cellRefs)];\n      if (itemsMap[ref]) {\n        if (itemsMap[ref]._id) {\n          var newArr = [itemsMap[ref], newItem];\n          itemsMap[ref] = newArr\n          return\n        }\n        if (itemsMap[ref][0] && !itemsMap[ref]._id) {\n          itemsMap[ref].push(newItem)\n          return\n        }\n        return;\n      }\n      itemsMap[ref] = newItem;\n\n    });\n  }, this);\n  return itemsMap;\n}\n\n","import moment from 'moment'\nimport PropTypes from 'prop-types';\nimport React, {Component} from 'react';\nimport {getLast, getFirst} from './helpers.js';\nimport './reactAgendaItem.css';\nimport HumanizeDuration from 'react-humanize-duration';\n\nexport default class ReactAgendaItem extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      wrapper:{\n        width: '150px',\n        marginLeft: '0px',\n        zIndex: 5,\n        borderLeft: null\n\n      },\n      controls:{\n\n      }\n\n\n    };\n    this.updateDimensions = this.updateDimensions.bind(this)\n    this.raiseZindex = this.raiseZindex.bind(this)\n    this.lowerZindex = this.lowerZindex.bind(this)\n\n  }\n\n  updateDimensions() {\nvar elem = document.getElementById(this.props.parent)\nif(elem){\n  var nwidh = (elem.offsetWidth / 1.4)\n  var nmrgl = this.props.padder > 0\n    ? (nwidh / 5) + this.props.padder * 8\n    : (nwidh / 5)\n\n  return this.setState({wrapper:{\n    width: nwidh + 'px',\n    marginLeft: nmrgl + 'px',\n    marginTop: (this.props.padder * 8) + 'px',\n    zIndex: 5,\n  }\n  })\n\n}\n\n  }\n\n  componentWillReceiveProps(props, next) {\n    setTimeout(function() {\n      this.updateDimensions();\n    }.bind(this), 50);\n\n  }\n\n  componentDidMount() {\n    window.addEventListener(\"resize\", this.updateDimensions);\n\n    this.updateDimensions();\n\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"resize\", this.updateDimensions);\n  }\n\n  lowerZindex(e) {\n    let sty = this.state.wrapper;\n\n    if (sty.zIndex === 8) {\n      var newState = { wrapper: Object.assign({} , sty , {zIndex:5} ) };\n      return this.setState(newState)\n    }\n\n  }\n  raiseZindex(e) {\n    let sty = this.state.wrapper;\n\n    if (sty.zIndex === 5) {\n\n      var newState = { wrapper: Object.assign({} , sty , {zIndex:8} )};\n      return this.setState(newState)\n    }\n\n  }\n\n  render() {\n\n    var duratH = moment.duration(this.props.item.duration._milliseconds, 'Milliseconds').humanize();\n    var duratL = moment(this.props.item.startDateTime).format(\"HH:mm\")\n    var duratE = moment(this.props.item.endDateTime).format(\"HH:mm\")\n\n    return <div style={this.state.wrapper} className=\"agenda-cell-item\" onMouseEnter={this.raiseZindex} onMouseLeave={this.lowerZindex}>\n\n              <div className=\"agenda-controls-item\" style={this.state.controls}>\n               {this.props.edit?\n                <div className=\"agenda-edit-event\">\n                  <a onClick={() => this.props.edit(this.props.item)} className=\"agenda-edit-modele\">\n                    <i className=\"edit-item-icon\"></i>\n                  </a>\n                </div>:''}\n                {this.props.remove?\n                <div className=\"agenda-delete-event\">\n                  <a onClick={() => this.props.remove(this.props.item)} className=\"agenda-delete-modele\">\n                    <i className=\"remove-item-icon\"></i>\n                  </a>\n                </div>:''}\n              </div>\n\n            <div className=\"agenda-item-description\">\n              <section>{this.props.item.name}</section>\n            <small>\n              , {duratL} - {duratE} , <HumanizeDuration duration={this.props.item.duration._milliseconds} largest={2} round={true}/>\n            </small>\n          </div>\n\n    </div>\n\n  }\n}\n\nReactAgendaItem.propTypes = {\n  parent: PropTypes.string,\n  item: PropTypes.object,\n  padder: PropTypes.number,\n  edit: PropTypes.func,\n  remove: PropTypes.func\n\n};\n\nReactAgendaItem.defaultProps = {\n  parent: 'body',\n  item: {},\n  padder: 0\n}\n","var DragDropTouch;\n(function (DragDropTouch_1) {\n    'use strict';\n    /**\n     * Object used to hold the data that is being dragged during drag and drop operations.\n     *\n     * It may hold one or more data items of different types. For more information about\n     * drag and drop operations and data transfer objects, see\n     * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/DataTransfer\">HTML Drag and Drop API</a>.\n     *\n     * This object is created automatically by the @see:DragDropTouch singleton and is\n     * accessible through the @see:dataTransfer property of all drag events.\n     */\n    var DataTransfer = (function () {\n        function DataTransfer() {\n            this._dropEffect = 'move';\n            this._effectAllowed = 'all';\n            this._data = {};\n        }\n        Object.defineProperty(DataTransfer.prototype, \"dropEffect\", {\n            /**\n             * Gets or sets the type of drag-and-drop operation currently selected.\n             * The value must be 'none',  'copy',  'link', or 'move'.\n             */\n            get: function () {\n                return this._dropEffect;\n            },\n            set: function (value) {\n                this._dropEffect = value;\n            },\n            enumerable: true,\n            configurable: true\n        });\n        Object.defineProperty(DataTransfer.prototype, \"effectAllowed\", {\n            /**\n             * Gets or sets the types of operations that are possible.\n             * Must be one of 'none', 'copy', 'copyLink', 'copyMove', 'link',\n             * 'linkMove', 'move', 'all' or 'uninitialized'.\n             */\n            get: function () {\n                return this._effectAllowed;\n            },\n            set: function (value) {\n                this._effectAllowed = value;\n            },\n            enumerable: true,\n            configurable: true\n        });\n        Object.defineProperty(DataTransfer.prototype, \"types\", {\n            /**\n             * Gets an array of strings giving the formats that were set in the @see:dragstart event.\n             */\n            get: function () {\n                return Object.keys(this._data);\n            },\n            enumerable: true,\n            configurable: true\n        });\n        /**\n         * Removes the data associated with a given type.\n         *\n         * The type argument is optional. If the type is empty or not specified, the data\n         * associated with all types is removed. If data for the specified type does not exist,\n         * or the data transfer contains no data, this method will have no effect.\n         *\n         * @param type Type of data to remove.\n         */\n        DataTransfer.prototype.clearData = function (type) {\n            if (type != null) {\n                delete this._data[type];\n            }\n            else {\n                this._data = null;\n            }\n        };\n        /**\n         * Retrieves the data for a given type, or an empty string if data for that type does\n         * not exist or the data transfer contains no data.\n         *\n         * @param type Type of data to retrieve.\n         */\n        DataTransfer.prototype.getData = function (type) {\n            return this._data[type] || '';\n        };\n        /**\n         * Set the data for a given type.\n         *\n         * For a list of recommended drag types, please see\n         * https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Recommended_Drag_Types.\n         *\n         * @param type Type of data to add.\n         * @param value Data to add.\n         */\n        DataTransfer.prototype.setData = function (type, value) {\n            this._data[type] = value;\n        };\n        /**\n         * Set the image to be used for dragging if a custom one is desired.\n         *\n         * @param img An image element to use as the drag feedback image.\n         * @param offsetX The horizontal offset within the image.\n         * @param offsetY The vertical offset within the image.\n         */\n        DataTransfer.prototype.setDragImage = function (img, offsetX, offsetY) {\n            var ddt = DragDropTouch._instance;\n            ddt._imgCustom = img;\n            ddt._imgOffset = { x: offsetX, y: offsetY };\n        };\n        return DataTransfer;\n    })();\n    DragDropTouch_1.DataTransfer = DataTransfer;\n    /**\n     * Defines a class that adds support for touch-based HTML5 drag/drop operations.\n     *\n     * The @see:DragDropTouch class listens to touch events and raises the\n     * appropriate HTML5 drag/drop events as if the events had been caused\n     * by mouse actions.\n     *\n     * The purpose of this class is to enable using existing, standard HTML5\n     * drag/drop code on mobile devices running IOS or Android.\n     *\n     * To use, include the DragDropTouch.js file on the page. The class will\n     * automatically start monitoring touch events and will raise the HTML5\n     * drag drop events (dragstart, dragenter, dragleave, drop, dragend) which\n     * should be handled by the application.\n     *\n     * For details and examples on HTML drag and drop, see\n     * https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Drag_operations.\n     */\n    var DragDropTouch = (function () {\n        /**\n         * Initializes the single instance of the @see:DragDropTouch class.\n         */\n        function DragDropTouch() {\n            this._lastClick = 0;\n            // enforce singleton pattern\n            if (DragDropTouch._instance) {\n                throw 'DragDropTouch instance already created.';\n            }\n            // listen to touch events\n            if ('ontouchstart' in document) {\n                var d = document, ts = this._touchstart.bind(this), tm = this._touchmove.bind(this), te = this._touchend.bind(this);\n                d.addEventListener('touchstart', ts);\n                d.addEventListener('touchmove', tm);\n                d.addEventListener('touchend', te);\n                d.addEventListener('touchcancel', te);\n            }\n        }\n        /**\n         * Gets a reference to the @see:DragDropTouch singleton.\n         */\n        DragDropTouch.getInstance = function () {\n            return DragDropTouch._instance;\n        };\n        // ** event handlers\n        DragDropTouch.prototype._touchstart = function (e) {\n            var _this = this;\n            if (this._shouldHandle(e)) {\n                // raise double-click and prevent zooming\n                if (Date.now() - this._lastClick < DragDropTouch._DBLCLICK) {\n                    if (this._dispatchEvent(e, 'dblclick', e.target)) {\n                        e.preventDefault();\n                        this._reset();\n                        return;\n                    }\n                }\n                // clear all variables\n                this._reset();\n                // get nearest draggable element\n                var src = this._closestDraggable(e.target);\n                if (src) {\n                    // give caller a chance to handle the hover/move events\n                    if (!this._dispatchEvent(e, 'mousemove', e.target) &&\n                        !this._dispatchEvent(e, 'mousedown', e.target)) {\n                        // get ready to start dragging\n                        this._dragSource = src;\n                        this._ptDown = this._getPoint(e);\n                        this._lastTouch = e;\n                        e.preventDefault();\n                        // show context menu if the user hasn't started dragging after a while\n                        setTimeout(function () {\n                            if (_this._dragSource == src && _this._img == null) {\n                                if (_this._dispatchEvent(e, 'contextmenu', src)) {\n                                    _this._reset();\n                                }\n                            }\n                        }, DragDropTouch._CTXMENU);\n                    }\n                }\n            }\n        };\n        DragDropTouch.prototype._touchmove = function (e) {\n            if (this._shouldHandle(e)) {\n                // see if target wants to handle move\n                var target = this._getTarget(e);\n                if (this._dispatchEvent(e, 'mousemove', target)) {\n                    this._lastTouch = e;\n                    e.preventDefault();\n                    return;\n                }\n                // start dragging\n                if (this._dragSource && !this._img) {\n                    var delta = this._getDelta(e);\n                    if (delta > DragDropTouch._THRESHOLD) {\n                        this._dispatchEvent(e, 'dragstart', this._dragSource);\n                        this._createImage(e);\n                        this._dispatchEvent(e, 'dragenter', target);\n                    }\n                }\n                // continue dragging\n                if (this._img) {\n                    this._lastTouch = e;\n                    e.preventDefault(); // prevent scrolling\n                    if (target != this._lastTarget) {\n                        this._dispatchEvent(this._lastTouch, 'dragleave', this._lastTarget);\n                        this._dispatchEvent(e, 'dragenter', target);\n                        this._lastTarget = target;\n                    }\n                    this._moveImage(e);\n                    this._dispatchEvent(e, 'dragover', target);\n                }\n            }\n        };\n        DragDropTouch.prototype._touchend = function (e) {\n            if (this._shouldHandle(e)) {\n                // see if target wants to handle up\n                if (this._dispatchEvent(this._lastTouch, 'mouseup', e.target)) {\n                    e.preventDefault();\n                    return;\n                }\n                // user clicked the element but didn't drag, so clear the source and simulate a click\n                if (!this._img) {\n                    this._dragSource = null;\n                    this._dispatchEvent(this._lastTouch, 'click', e.target);\n                    this._lastClick = Date.now();\n                }\n                // finish dragging\n                this._destroyImage();\n                if (this._dragSource) {\n                    if (e.type.indexOf('cancel') < 0) {\n                        this._dispatchEvent(this._lastTouch, 'drop', this._lastTarget);\n                    }\n                    this._dispatchEvent(this._lastTouch, 'dragend', this._dragSource);\n                    this._reset();\n                }\n            }\n        };\n        // ** utilities\n        // ignore events that have been handled or that involve more than one touch\n        DragDropTouch.prototype._shouldHandle = function (e) {\n            return e &&\n                !e.defaultPrevented &&\n                e.touches && e.touches.length < 2;\n        };\n        // clear all members\n        DragDropTouch.prototype._reset = function () {\n            this._destroyImage();\n            this._dragSource = null;\n            this._lastTouch = null;\n            this._lastTarget = null;\n            this._ptDown = null;\n            this._dataTransfer = new DataTransfer();\n        };\n        // get point for a touch event\n        DragDropTouch.prototype._getPoint = function (e, page) {\n            if (e && e.touches) {\n                e = e.touches[0];\n            }\n            return { x: page ? e.pageX : e.clientX, y: page ? e.pageY : e.clientY };\n        };\n        // get distance between the current touch event and the first one\n        DragDropTouch.prototype._getDelta = function (e) {\n            var p = this._getPoint(e);\n            return Math.abs(p.x - this._ptDown.x) + Math.abs(p.y - this._ptDown.y);\n        };\n        // get the element at a given touch event\n        DragDropTouch.prototype._getTarget = function (e) {\n            var pt = this._getPoint(e), el = document.elementFromPoint(pt.x, pt.y);\n            while (el && getComputedStyle(el).pointerEvents == 'none') {\n                el = el.parentElement;\n            }\n            return el;\n        };\n        // create drag image from source element\n        DragDropTouch.prototype._createImage = function (e) {\n            // just in case...\n            if (this._img) {\n                this._destroyImage();\n            }\n            // create drag image from custom element or drag source\n            var src = this._imgCustom || this._dragSource;\n            this._img = src.cloneNode(true);\n            this._copyStyle(src, this._img);\n            this._img.style.top = this._img.style.left = '-9999px';\n            this._img.style['-webkit-transform'] = 'translateX(-9999px) translateY(-9999px)'\n            // if creating from drag source, apply offset and opacity\n            if (!this._imgCustom) {\n                var rc = src.getBoundingClientRect(), pt = this._getPoint(e);\n                this._imgOffset = {\n                    x: pt.x - rc.left,\n                    y: pt.y - rc.top\n                };\n                this._img.style.opacity = DragDropTouch._OPACITY.toString();\n            }\n            // add image to document\n            this._moveImage(e);\n            document.body.appendChild(this._img);\n        };\n        // dispose of drag image element\n        DragDropTouch.prototype._destroyImage = function () {\n            if (this._img && this._img.parentElement) {\n                this._img.parentElement.removeChild(this._img);\n            }\n            this._img = null;\n            this._imgCustom = null;\n        };\n        // move the drag image element\n        DragDropTouch.prototype._moveImage = function (e) {\n            var _this = this;\n            requestAnimationFrame(function () {\n                var pt = _this._getPoint(e, true), s = _this._img.style;\n                s.position = 'fixed';\n                s.pointerEvents = 'none';\n                s.zIndex = '999999';\n                s.top = s.left = '0px'\n                var left = Math.round(pt.x - _this._imgOffset.x);\n                var top = Math.round(pt.y - _this._imgOffset.y);\n\n            });\n        };\n        // copy properties from an object to another\n        DragDropTouch.prototype._copyProps = function (dst, src, props) {\n            for (var i = 0; i < props.length; i++) {\n                var p = props[i];\n                dst[p] = src[p];\n            }\n        };\n        DragDropTouch.prototype._copyStyle = function (src, dst) {\n            // remove potentially troublesome attributes\n            DragDropTouch._rmvAtts.forEach(function (att) {\n                dst.removeAttribute(att);\n            });\n            // copy canvas content\n            if (src instanceof HTMLCanvasElement) {\n                var cSrc = src, cDst = dst;\n                cDst.width = cSrc.width;\n                cDst.height = cSrc.height;\n                cDst.getContext('2d').drawImage(cSrc, 0, 0);\n            }\n            // copy style\n            var cs = getComputedStyle(src);\n            for (var i = 0; i < cs.length; i++) {\n                var key = cs[i];\n                dst.style[key] = cs[key];\n            }\n            dst.style.pointerEvents = 'none';\n            // and repeat for all children\n            for (var i = 0; i < src.children.length; i++) {\n                this._copyStyle(src.children[i], dst.children[i]);\n            }\n        };\n        DragDropTouch.prototype._dispatchEvent = function (e, type, target) {\n            if (e && target) {\n                var evt = document.createEvent('Event'), t = e.touches ? e.touches[0] : e;\n                evt.initEvent(type, true, true);\n                evt.button = 0;\n                evt.which = evt.buttons = 1;\n                this._copyProps(evt, e, DragDropTouch._kbdProps);\n                this._copyProps(evt, t, DragDropTouch._ptProps);\n                evt.dataTransfer = this._dataTransfer;\n                target.dispatchEvent(evt);\n                return evt.defaultPrevented;\n            }\n            return false;\n        };\n        // gets an element's closest draggable ancestor\n        DragDropTouch.prototype._closestDraggable = function (e) {\n            for (; e; e = e.parentElement) {\n                if (e.hasAttribute('draggable')) {\n                    return e;\n                }\n            }\n            return null;\n        };\n        /*private*/ DragDropTouch._instance = new DragDropTouch(); // singleton\n        // constants\n        DragDropTouch._THRESHOLD = 5; // pixels to move before drag starts\n        DragDropTouch._OPACITY = 0.5; // drag image opacity\n        DragDropTouch._DBLCLICK = 500; // max ms between clicks in a double click\n        DragDropTouch._CTXMENU = 900; // ms to hold before raising 'contextmenu' event\n        // copy styles/attributes from drag source to drag image element\n        DragDropTouch._rmvAtts = 'id,class,style,draggable'.split(',');\n        // synthesize and dispatch an event\n        // returns true if the event has been handled (e.preventDefault == true)\n        DragDropTouch._kbdProps = 'altKey,ctrlKey,metaKey,shiftKey'.split(',');\n        DragDropTouch._ptProps = 'pageX,pageY,clientX,clientY,screenX,screenY'.split(',');\n        return DragDropTouch;\n    })();\n    DragDropTouch_1.DragDropTouch = DragDropTouch;\n})(DragDropTouch || (DragDropTouch = {}));\n//# sourceMappingURL=DragDropTouchNoWijmo.js.map\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport moment from \"moment\";\nimport ReactAgendaItem from \"./reactAgendaItem\";\nimport classNames from \"classnames\";\nimport { guid, getUnique, getLast, getFirst, mapItems } from \"./helpers.js\";\nimport * as DragDropHelper from \"./dragAndDropHelper.js\";\n\nvar startSelect;\n\nlet test;\nvar endSelect;\nvar isDragging = false;\nvar isMouseDown = false;\nvar draggedElement;\nvar timeNow = moment();\nvar draggedItem;\nvar ctrlKey = false;\n\nvar DEFAULT_ITEM = {\n  name: \"\",\n  classes: \"\",\n  cellRefs: [],\n};\n\nvar mouse = {\n  x: 0,\n  y: 0,\n  startX: 0,\n  startY: 0,\n};\nvar element = null;\nvar helper = null;\n\nexport default class ReactAgenda extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      date: moment(),\n      items: {},\n      itemOverlayStyles: {},\n      highlightedCells: [],\n      numberOfDays: 4,\n      autoScaleNumber: 0,\n      focusedCell: null,\n    };\n    this.handleBeforeUpdate = this.handleBeforeUpdate.bind(this);\n    this.handleOnNextButtonClick = this.handleOnNextButtonClick.bind(this);\n    this.handleOnPrevButtonClick = this.handleOnPrevButtonClick.bind(this);\n    this.handleMouseClick = this.handleMouseClick.bind(this);\n    this.handleMouseOver = this.handleMouseOver.bind(this);\n    this.removeSelection = this.removeSelection.bind(this);\n    this.handleAllClickStarts = this.handleAllClickStarts.bind(this);\n    this.handleAllClickEnds = this.handleAllClickEnds.bind(this);\n    this.onDragStart = this.onDragStart.bind(this);\n    this.onDragEnter = this.onDragEnter.bind(this);\n    this.onDragOver = this.onDragOver.bind(this);\n    this.onDragEnd = this.onDragEnd.bind(this);\n    this.onDragHandlerStart = this.onDragHandlerStart.bind(this);\n    this.onDragHandlerEnd = this.onDragHandlerEnd.bind(this);\n    this.getSelection = this.getSelection.bind(this);\n    this.editEvent = this.editEvent.bind(this);\n    this.removeEvent = this.removeEvent.bind(this);\n    this.dragEvent = this.dragEvent.bind(this);\n    this.duplicateEvent = this.duplicateEvent.bind(this);\n    this.resizeEvent = this.resizeEvent.bind(this);\n    this.updateDimensions = this.updateDimensions.bind(this);\n  }\n\n  /********************/\n  /*  Life Cycle      */\n  /********************/\n  componentWillMount() {\n    this.handleBeforeUpdate(this.props);\n    if (this.props.autoScale) {\n      window.removeEventListener(\"resize\", this.updateDimensions);\n    }\n    if (this.props.locale && this.props.locale != \"en\") {\n      moment.locale(this.props.locale);\n    }\n  }\n\n  componentWillReceiveProps(props) {\n    this.handleBeforeUpdate(props);\n  }\n\n  componentDidMount() {\n    if (this.props.autoScale) {\n      window.addEventListener(\"resize\", this.updateDimensions);\n      this.updateDimensions();\n    }\n  }\n\n  updateDimensions() {\n    var width = Math.round(\n      document.getElementById(\"agenda-wrapper\").offsetWidth / 150 - 1\n    );\n    this.setState({ autoScaleNumber: width, numberOfDays: width });\n  }\n\n  /********************/\n  /*  Item Renderers  */\n  /********************/\n  getHeaderColumns() {\n    var cols = [];\n    for (var i = 0; i < this.state.numberOfDays; i++) {\n      cols.push(moment(this.state.date).add(i, \"days\").toDate());\n    }\n    return cols;\n  }\n\n  getBodyRows() {\n    var rows = [];\n    var interval = 60 / this.props.rowsPerHour;\n\n    if (this.props.startAtTime && typeof this.props.startAtTime === \"number\") {\n      for (var i = 0; i < 24 * this.props.rowsPerHour; i++) {\n        if (\n          this.props.endAtTime != 0 &&\n          (this.props.endAtTime - this.props.startAtTime) *\n            this.props.rowsPerHour >=\n            i\n        ) {\n          rows.push(\n            moment(this.state.date)\n              .hours(this.props.startAtTime)\n              .minutes(0)\n              .seconds(0)\n              .milliseconds(0)\n              .add(Math.floor(i * interval), \"minutes\")\n          );\n        }\n      }\n      return rows;\n    }\n\n    for (var i = 0; i < 24 * this.props.rowsPerHour; i++) {\n      rows.push(\n        moment(this.state.date)\n          .hours(7)\n          .minutes(0)\n          .seconds(0)\n          .milliseconds(0)\n          .add(Math.floor(i * interval), \"minutes\")\n      );\n    }\n    return rows;\n  }\n\n  getMinuteCells(rowMoment) {\n    var cells = [];\n    for (var i = 0; i < this.state.numberOfDays; i++) {\n      var cellRef = moment(rowMoment)\n        .add(i, \"days\")\n        .format(\"YYYY-MM-DDTHH:mm:ss\");\n      cells.push({\n        cellRef: cellRef,\n        item: this.state.items[cellRef] || DEFAULT_ITEM,\n      });\n    }\n    return cells;\n  }\n\n  /********************/\n  /*  Event Handlers  */\n  /********************/\n  handleBeforeUpdate(props) {\n    if (\n      props.hasOwnProperty(\"startDate\") &&\n      props.startDate !== this.state.date.toDate()\n    ) {\n      this.setState({\n        date: moment(props.startDate),\n      });\n    }\n\n    if (props.hasOwnProperty(\"items\")) {\n      this.setState({\n        items: mapItems(props.items, props.rowsPerHour, props.timezone),\n      });\n    }\n\n    if (\n      props.hasOwnProperty(\"numberOfDays\") &&\n      props.numberOfDays !== this.state.numberOfDays &&\n      !this.props.autoScale\n    ) {\n      this.setState({ numberOfDays: props.numberOfDays });\n    }\n\n    if (\n      props.hasOwnProperty(\"minDate\") &&\n      (!this.state.hasOwnProperty(\"minDate\") ||\n        props.minDate !== this.state.minDate.toDate())\n    ) {\n      this.setState({\n        minDate: moment(props.minDate),\n      });\n    }\n\n    if (\n      props.hasOwnProperty(\"maxDate\") &&\n      (!this.state.hasOwnProperty(\"maxDate\") ||\n        props.maxDate !== this.state.maxDate.toDate())\n    ) {\n      this.setState({\n        maxDate: moment(props.maxDate),\n      });\n    }\n  }\n\n  handleOnNextButtonClick() {\n    var nextStartDate = moment(this.state.date).add(\n      this.state.numberOfDays,\n      \"days\"\n    );\n    if (this.state.hasOwnProperty(\"maxDate\")) {\n      nextStartDate = moment.min(nextStartDate, this.state.maxDate);\n    }\n\n    var newStart = nextStartDate;\n    var newEnd = moment(newStart).add(this.state.numberOfDays - 1, \"days\");\n\n    if (nextStartDate !== this.state.date) {\n      this.setState({ date: nextStartDate });\n    }\n\n    if (this.props.onDateRangeChange) {\n      this.props.onDateRangeChange(\n        newStart.startOf(\"day\").toDate(),\n        newEnd.endOf(\"day\").toDate()\n      );\n    }\n  }\n\n  handleOnPrevButtonClick() {\n    var prevStartDate = moment(this.state.date).subtract(\n      this.state.numberOfDays,\n      \"days\"\n    );\n    if (this.state.hasOwnProperty(\"minDate\")) {\n      prevStartDate = moment.max(prevStartDate, this.state.minDate);\n    }\n\n    var newStart = prevStartDate;\n    var newEnd = moment(newStart).add(this.state.numberOfDays - 1, \"days\");\n\n    if (prevStartDate !== this.state.date) {\n      this.setState({ date: prevStartDate });\n    }\n\n    if (this.props.onDateRangeChange) {\n      this.props.onDateRangeChange(newStart.toDate(), newEnd.toDate());\n    }\n  }\n\n  handleMouseClick(cell, bypass) {\n    if (typeof cell != \"string\" && cell.tagName) {\n      var dt = moment(cell.innerText, [\"h:mm A\"]).format(\"HH\");\n      var old = parseInt(dt);\n      var now = new Date();\n      var newdate = new Date(\n        now.getFullYear(),\n        now.getMonth(),\n        now.getDate(),\n        old + 1,\n        0\n      );\n      var mom = newdate\n        .toISOString()\n        .substring(0, newdate.toISOString().length - 5);\n      if (this.props.onCellSelect) {\n        return this.props.onCellSelect(mom, bypass);\n      }\n    }\n    if (this.props.onCellSelect) {\n      this.props.onCellSelect(cell, bypass);\n    }\n  }\n\n  setMousePosition(e) {\n    var ev = e || window.event; //Moz || IE\n\n    mouse.x = ev.pageX;\n    mouse.y = ev.pageY;\n  }\n\n  handleMouseOver(e) {\n    this.setMousePosition(e);\n    if (e.buttons === 0) {\n      return false;\n    }\n    e.preventDefault ? e.preventDefault() : (e.returnValue = false);\n    this.removeSelection();\n    if (element) {\n      element.style.width = Math.abs(mouse.x - mouse.startX) + \"px\";\n      element.style.height = Math.abs(mouse.y - mouse.startY) + \"px\";\n      element.style.left =\n        mouse.x - mouse.startX < 0 ? mouse.x + \"px\" : mouse.startX + \"px\";\n      element.style.top =\n        mouse.y - mouse.startY < 0 ? mouse.y + \"px\" : mouse.startY + \"px\";\n    }\n\n    if (helper) {\n      helper.style.left = mouse.x + \"px\";\n      helper.style.top = mouse.y + \"px\";\n      if (\n        e.target.classList.contains(\"agenda__cell\") &&\n        !e.target.classList.contains(\"--time\")\n      ) {\n        var strt = moment(startSelect);\n        var endd = moment(e.target.id);\n\n        helper.innerHTML =\n          endd.diff(strt) > 0\n            ? strt.format(\"LT\") + \" -- \" + endd.format(\"LT\")\n            : endd.format(\"LT\") + \" -- \" + strt.format(\"LT\");\n      }\n    }\n  }\n\n  removeSelection() {\n    var old = document.getElementsByClassName(\"agenda__cell_selected\");\n\n    for (var i = old.length - 1; i >= 0; --i) {\n      if (old[i]) {\n        old[i].classList.remove(\"agenda__cell_selected\");\n      }\n    }\n  }\n\n  handleAllClickStarts(e, n) {\n    isMouseDown = true;\n\n    this.removeSelection();\n    if (\n      e.target.classList.contains(\"--time\") ||\n      (e.target.classList.contains(\"--time-now\") && !isDragging)\n    ) {\n      return this.handleMouseClick(e.target);\n    }\n\n    if (\n      e.target.classList.contains(\"agenda__cell\") &&\n      !e.target.classList.contains(\"--time\") &&\n      !isDragging\n    ) {\n      this.removeSelection();\n      e.target.classList.toggle(\"agenda__cell_selected\");\n      startSelect = e.target.id;\n      if (e.buttons === 0) {\n        return false;\n      }\n      this.handleMouseClick(e.target.id);\n      mouse.startX = mouse.x;\n      mouse.startY = mouse.y;\n      element = document.createElement(\"div\");\n      element.className = \"rectangle\";\n      element.style.left = mouse.x + \"px\";\n      element.style.top = mouse.y + \"px\";\n      document.body.appendChild(element);\n\n      if (this.props.helper) {\n        helper = document.createElement(\"div\");\n        helper.className = \"helper-reactangle\";\n        document.body.appendChild(helper);\n      }\n    }\n  }\n\n  handleAllClickEnds(e, n) {\n    //  e.preventDefault ? e.preventDefault() : e.returnValue = false\n    isMouseDown = false;\n    isDragging = false;\n\n    endSelect = e.target.id;\n\n    var old = document.getElementsByClassName(\"rectangle\");\n    var old2 = document.getElementsByClassName(\"helper-reactangle\");\n\n    for (var i = old.length - 1; i >= 0; --i) {\n      if (old[i]) {\n        old[i].remove();\n      }\n    }\n\n    for (var i = old2.length - 1; i >= 0; --i) {\n      if (old2[i]) {\n        old2[i].remove();\n      }\n    }\n    element = null;\n    helper = null;\n\n    if (startSelect && endSelect && startSelect != endSelect) {\n      return this.getSelection(startSelect, endSelect);\n    }\n  }\n\n  /**************** ****/\n  /*  Drag Handlers   */\n  /*******************/\n\n  onDragStart(e) {\n    isDragging = true;\n    isMouseDown = false;\n    draggedItem = e.target.id;\n    e.dataTransfer.setData(\"text/html\", e.target);\n    e.dataTransfer.dropEffect = \"move\";\n    e.dataTransfer.setDragImage(e.target, 0, 0);\n  }\n\n  onDragEnter(e) {\n    e.preventDefault();\n    if (!isDragging) {\n      this.removeSelection();\n    }\n    e.dataTransfer.dropEffect = \"move\";\n    if (e.ctrlKey) {\n      e.dataTransfer.effectAllowed = \"copy\";\n      e.dataTransfer.dropEffect = \"copy\";\n    }\n  }\n\n  onDragOver(e) {\n    e.preventDefault();\n    e.stopPropagation();\n\n    if (e.target.id === draggedElement) {\n      return false;\n    }\n\n    if (e.ctrlKey) {\n      e.dataTransfer.effectAllowed = \"copy\";\n      ctrlKey = true;\n    } else {\n      e.dataTransfer.dropEffect = \"move\";\n    }\n\n    if (e.target.classList.contains(\"cell-item\")) {\n      return (draggedElement = e.target.parentNode.parentNode.id);\n    }\n\n    if (e.target.classList.contains(\"handler\")) {\n      return (draggedElement = e.target.parentNode.id);\n    }\n    if (e.target.classList.contains(\"dragDiv\")) {\n      return (draggedElement = e.target.parentNode.id);\n    }\n\n    draggedElement = e.target.id;\n  }\n\n  dragEvent(id, d) {\n    if (!this.props.onChangeEvent) {\n      return;\n    }\n    var date = d;\n    var itm;\n    if (!this.refs[d]) {\n      return;\n    }\n    if (this.refs[d].tagName !== \"TD\") {\n      // when user drag and drop an event into another we assign parent id\n      date = this.refs[d].parentNode.id;\n    }\n    var items = this.props.items;\n    if (id && date && items) {\n      for (var i in items) {\n        if (items[i]._id === id) {\n          var start = moment(items[i].startDateTime);\n          var end = moment(items[i].endDateTime);\n          var duration = moment.duration(end.diff(start));\n          let newdate = moment(date).subtract(\n            duration % (60 / this.state.rowsPerHour)\n          );\n          let newEnddate = moment(newdate).add(duration);\n          items[i].startDateTime = new Date(newdate);\n          items[i].endDateTime = new Date(newEnddate);\n          itm = items[i];\n          break;\n        }\n      }\n      this.props.onChangeEvent(items, itm);\n    }\n  }\n\n  duplicateEvent(id, d) {\n    var date = d;\n    var itm;\n    var oldItm;\n    if (!this.refs[d]) {\n      return;\n    }\n    if (this.refs[d].tagName !== \"TD\") {\n      // when user drag and drop an event into another we assign parent id\n      date = this.refs[d].parentNode.id;\n    }\n    var items = this.props.items;\n    if (id && date && items) {\n      for (var i in items) {\n        if (items[i]._id === id) {\n          itm = Object.assign({}, items[i], { _id: guid() });\n          var start = moment(itm.startDateTime);\n          var end = moment(itm.endDateTime);\n          var duration = moment.duration(end.diff(start));\n          let newdate = moment(date);\n          let newEnddate = moment(newdate).add(duration);\n          itm.startDateTime = new Date(newdate);\n          itm.endDateTime = new Date(newEnddate);\n          items.push(itm);\n          if (this.props.onChangeEvent) {\n            this.props.onChangeEvent(items, itm);\n          }\n          break;\n        }\n      }\n    }\n  }\n\n  resizeEvent(id, date) {\n    if (!this.props.onChangeDuration) {\n      return;\n    }\n\n    var items = this.props.items;\n    if (id && date && items) {\n      for (var i in items) {\n        if (items[i]._id === id) {\n          var difference = new Date(date) - new Date(items[i].startDateTime);\n          if (difference < 1) {\n            let strt = new Date(items[i].startDateTime);\n            items[i].endDateTime = new Date(\n              strt.getFullYear(),\n              strt.getMonth(),\n              strt.getDate(),\n              strt.getHours(),\n              strt.getMinutes() + 15,\n              0\n            );\n            this.setState({ items: items });\n            return this.props.onChangeDuration(items, items[i]);\n          }\n          let newdate = moment(date);\n          items[i].endDateTime = new Date(newdate);\n          return this.props.onChangeDuration(items, items[i]);\n          break;\n        }\n      }\n    }\n  }\n\n  onDragEnd(e) {\n    let newDate = draggedElement;\n\n    if (ctrlKey) {\n      this.duplicateEvent(e.target.id, newDate);\n    } else {\n      this.dragEvent(e.target.id, newDate);\n    }\n    isDragging = false;\n    isMouseDown = false;\n    ctrlKey = false;\n    draggedElement = \"\";\n    draggedItem = \"\";\n  }\n\n  onDragHandlerStart(e) {\n    isDragging = true;\n    e.dataTransfer.setData(\"text/html\", e.target);\n    e.dataTransfer.dropEffect = \"move\";\n    //e.dataTransfer.setData(\"text/html\", e.target);\n    e.dataTransfer.effectAllowed = \"all\";\n  }\n\n  onDragHandlerEnd(e, n) {\n    if (typeof draggedElement === undefined || draggedElement === \"\") {\n      return;\n    }\n    let item = e.target.id || e.target.offsetParent.id;\n\n    if (\n      this.refs[draggedElement] &&\n      this.refs[e.target.id] &&\n      this.refs[e.target.id].tagName === \"DIV\" &&\n      this.refs[draggedElement].tagName === \"DIV\"\n    ) {\n      //detect if we are resizing an event\n      item = e.target.id;\n      draggedElement = this.refs[draggedElement].parentNode.id;\n      return this.resizeEvent(item, draggedElement);\n    }\n\n    if (\n      draggedElement === \"\" &&\n      !this.refs[draggedElement] &&\n      this.refs[e.target.id].tagName === \"DIV\"\n    ) {\n      // when user drag and drop an event into another we assign parent id\n      draggedElement = this.refs[e.target.id].parentNode.id;\n      return;\n    }\n\n    if (!this.refs[draggedElement] && draggedElement) {\n      //detect if we are dragging an event from its description panel (item component)\n      var old = document.getElementById(draggedElement);\n      draggedElement = old.parentNode.id;\n    }\n\n    this.resizeEvent(item, draggedElement);\n\n    isDragging = false;\n    isMouseDown = false;\n    draggedElement = \"\";\n  }\n\n  /**************************/\n  /*  selection Handlers   */\n  /************************/\n\n  getSelection(start, end) {\n    // var array = [];\n    // var array2 = [];\n    // var old = document.getElementsByClassName('agenda__cell_selected')\n\n    // array = Object.keys(old).map(function(value, index) {\n    //   return old[value].id;\n    // })\n    // var last = moment(getLast(array));\n    // var addon = last.add((60 / this.props.rowsPerHour), 'Minutes')\n    // array.push(addon.format('YYYY-MM-DDTHH:mm:00'))\n\n    // if (this.props.onRangeSelection) {\n    //   console.log('array' , array)\n    //   this.props.onRangeSelection(array);\n    // }\n    var strt = moment(start);\n    var endd = moment(end);\n    var arr = endd.diff(strt) > 0 ? [start, end] : [end, start];\n\n    this.props.onRangeSelection(arr);\n  }\n\n  /***************************/\n  /*  EVENTS MODIFiCATION   */\n  /*************************/\n\n  editEvent(props) {\n    if (this.props.onItemEdit) {\n      this.props.onItemEdit(props, true);\n    }\n  }\n\n  removeEvent(item) {\n    var items = this.props.items;\n    var newItems = items.filter(function (el) {\n      return el._id !== item._id;\n    });\n    if (this.props.onItemRemove) {\n      this.props.onItemRemove(newItems, item);\n    }\n  }\n\n  render() {\n    var renderHeaderColumns = function (col, i) {\n      var headerLabel = moment(col);\n      headerLabel.locale(this.props.locale);\n      return (\n        <th\n          ref={\"column-\" + (i + 1)}\n          key={\"col-\" + i}\n          className=\"agenda__cell --head\"\n        >\n          {this.props.headFormat\n            ? headerLabel.format(this.props.headFormat)\n            : headerLabel.format(\"dddd DD MMM YY\")}\n        </th>\n      );\n    };\n\n    var renderBodyRows = function (row, i) {\n      if (i % this.props.rowsPerHour === 0) {\n        var ref = \"hour-\" + Math.floor(i / this.props.rowsPerHour);\n        var timeLabel = moment(row);\n        var differ = timeLabel.diff(timeNow, \"minutes\");\n\n        timeLabel.locale(this.props.locale);\n        return (\n          <tr\n            key={\"row-\" + i}\n            ref={ref}\n            draggable={false}\n            className=\"agenda__row   --hour-start\"\n          >\n            <td\n              className={\n                differ <= 60 && differ >= 0\n                  ? \"disable-select agenda__cell --time-now\"\n                  : \"disable-select agenda__cell --time\"\n              }\n              rowSpan={this.props.rowsPerHour}\n            >\n              {timeLabel.format(\"LT\")}\n            </td>\n            {this.getMinuteCells(row).map(renderMinuteCells, this)}\n          </tr>\n        );\n      } else {\n        return (\n          <tr key={\"row-\" + i}>\n            {this.getMinuteCells(row).map(renderMinuteCells, this)}\n          </tr>\n        );\n      }\n    };\n\n    var itmName;\n\n    var Colors = this.props.itemColors;\n\n    var ItemComponent = this.props.itemComponent\n      ? this.props.itemComponent\n      : ReactAgendaItem;\n\n    var renderItemCells = function (cell, i) {\n      var cellClasses = {\n        agenda__cell: true,\n      };\n      cell[\"item\"].forEach(function (itm) {\n        cellClasses[itm.classes] = true;\n      });\n\n      var classSet = classNames(cellClasses);\n\n      var splt = classSet.split(\" \");\n\n      splt = splt.filter((i) => !i.includes(\"agenda__cell\"));\n      splt = splt.filter((i) => !i.includes(\"undefined\"));\n\n      var nwsplt = [];\n      splt.forEach(function (value) {\n        if (value.length > 0) {\n          nwsplt.push(Colors[value]);\n        }\n      });\n\n      var styles = {\n        height: this.props.cellHeight + \"px\",\n      };\n      if (splt.length > 1) {\n        if (nwsplt[1] === nwsplt[2]) {\n          nwsplt.splice(1, 0, \"rgb(255,255,255)\");\n        }\n        nwsplt = nwsplt.join(\" , \");\n        styles = {\n          background: \"linear-gradient(-100deg,\" + nwsplt + \")\",\n          height: this.props.cellHeight + \"px\",\n        };\n      }\n\n      var itemElement = cell.item.map(\n        function (item, idx) {\n          var last1 = getLast(item.cellRefs);\n          var first1 = getFirst(item.cellRefs);\n\n          if (first1 === cell.cellRef) {\n            return (\n              <div\n                id={item._id}\n                ref={cell.cellRef}\n                key={idx}\n                className=\"dragDiv\"\n                onDragStart={this.onDragStart}\n                onDragEnd={this.onDragEnd}\n                draggable=\"true\"\n              >\n                {first1 === cell.cellRef ? (\n                  <i className=\"drag-handle-icon\" aria-hidden=\"true\"></i>\n                ) : (\n                  \"\"\n                )}\n                {first1 === cell.cellRef ? (\n                  <ItemComponent\n                    item={item}\n                    parent={cell.cellRef}\n                    itemColors={Colors}\n                    edit={this.props.onItemEdit ? this.editEvent : null}\n                    remove={this.props.onItemRemove ? this.removeEvent : null}\n                    days={this.props.numberOfDays}\n                  />\n                ) : (\n                  \"\"\n                )}\n              </div>\n            );\n          }\n\n          if (last1 === cell.cellRef && this.props.onChangeDuration) {\n            return (\n              <div\n                className=\"handler\"\n                style={{\n                  marginLeft: 8 * (idx + 1) + \"px\",\n                }}\n                id={item._id}\n                key={item._id}\n                onDragStart={this.onDragHandlerStart}\n                onDragEnd={this.onDragHandlerEnd}\n                draggable=\"true\"\n              >\n                <i className=\"resize-handle-icon\"></i>\n              </div>\n            );\n          }\n\n          return \"\";\n        }.bind(this)\n      );\n\n      return (\n        <td\n          ref={cell.cellRef}\n          key={\"cell-\" + i}\n          className={classSet}\n          style={styles}\n          id={cell.cellRef}\n        >\n          {itemElement}\n        </td>\n      );\n    }.bind(this);\n\n    var renderMinuteCells = function (cell, i) {\n      if (cell.item[0] && !cell.item._id) {\n        return renderItemCells(cell, i);\n      }\n\n      var cellClasses = {\n        agenda__cell: true,\n      };\n\n      cellClasses[cell.item.classes] = true;\n      if (cell.item.cellRefs) {\n        var last = getLast(cell.item.cellRefs);\n        var first = getFirst(cell.item.cellRefs);\n      }\n\n      var classSet = classNames(cellClasses);\n\n      var splt = classSet.split(\" \");\n      splt = splt.filter((i) => !i.includes(\"agenda__cell\"));\n      splt = splt.filter((i) => !i.includes(\"undefined\"));\n      var nwsplt = [];\n      splt.forEach(function (value) {\n        if (value.length > 0) {\n          nwsplt.push(Colors[value]);\n        }\n      });\n\n      var styles = {\n        height: this.props.cellHeight + \"px\",\n      };\n      if (splt.length > 1) {\n        nwsplt = nwsplt.join(\" , \");\n        styles = {\n          background: \"linear-gradient(to left,\" + nwsplt + \")\",\n          height: this.props.cellHeight + \"px\",\n        };\n      }\n\n      if (splt.length == 1) {\n        styles = {\n          background: nwsplt[0],\n          height: this.props.cellHeight + \"px\",\n        };\n      }\n\n      return (\n        <td\n          ref={cell.cellRef}\n          key={\"cell-\" + i}\n          className={classSet}\n          style={styles}\n          id={cell.cellRef}\n        >\n          {first === cell.cellRef ? (\n            <div\n              id={cell.item._id}\n              ref={cell.item._id}\n              className=\"dragDiv\"\n              onDragStart={this.onDragStart}\n              onDragEnd={this.onDragEnd}\n              draggable=\"true\"\n            >\n              {first === cell.cellRef && this.props.onChangeEvent ? (\n                <i className=\"drag-handle-icon\" aria-hidden=\"true\"></i>\n              ) : (\n                \"\"\n              )}\n              {first === cell.cellRef ? (\n                <ItemComponent\n                  item={cell.item}\n                  parent={cell.cellRef}\n                  itemColors={Colors}\n                  edit={this.props.onItemEdit ? this.editEvent : null}\n                  remove={this.props.onItemRemove ? this.removeEvent : null}\n                  days={this.props.numberOfDays}\n                />\n              ) : (\n                \"\"\n              )}\n            </div>\n          ) : (\n            \"\"\n          )}\n\n          {last === cell.cellRef && this.props.onChangeDuration ? (\n            <div\n              className=\"handler\"\n              id={cell.item._id}\n              onDragStart={this.onDragHandlerStart}\n              onDragEnd={this.onDragHandlerEnd}\n              draggable=\"true\"\n            >\n              <i className=\"resize-handle-icon\"></i>\n            </div>\n          ) : (\n            \"\"\n          )}\n        </td>\n      );\n    };\n\n    var disablePrev = function (state) {\n      if (!state.hasOwnProperty(\"minDate\")) {\n        return false;\n      }\n\n      return state.date.toDate().getTime() === state.minDate.toDate().getTime();\n    };\n\n    var disableNext = function (state) {\n      if (!state.hasOwnProperty(\"maxDate\")) {\n        return false;\n      }\n\n      return state.date.toDate().getTime() === state.maxDate.toDate().getTime();\n    };\n\n    return (\n      <div className=\"agenda\" id=\"agenda-wrapper\">\n        <div className=\"agenda__table --header\">\n          <table>\n            <thead>\n              <tr>\n                <th ref=\"column-0\" className=\"agenda__cell --controls\">\n                  <div className=\"agenda-controls-layout\">\n                    <button\n                      className={\n                        \"agenda__prev\" +\n                        (disablePrev(this.state) ? \" --disabled\" : \"\")\n                      }\n                      onClick={this.handleOnPrevButtonClick}\n                    ></button>\n                    <button\n                      className={\n                        \"agenda__next\" +\n                        (disableNext(this.state) ? \" --disabled\" : \"\")\n                      }\n                      onClick={this.handleOnNextButtonClick}\n                    ></button>\n                  </div>\n                </th>\n                {this.getHeaderColumns(this.props.view).map(\n                  renderHeaderColumns,\n                  this\n                )}\n              </tr>\n            </thead>\n          </table>\n        </div>\n\n        <div\n          ref=\"agendaScrollContainer\"\n          className=\"agenda__table --body\"\n          style={{\n            position: \"relative\",\n          }}\n        >\n          <table cellSpacing=\"0\" cellPadding=\"0\">\n            <tbody\n            // onMouseDown={disableDrag ? null : this.handleAllClickStarts}\n            // onDragEnter={disableDrag ? null : this.onDragEnter}\n            // onDragOver={disableDrag ? null : this.onDragOver}\n            // onMouseUp={disableDrag ? null : this.handleAllClickEnds}\n            // onMouseOver={disableDrag ? null : this.handleMouseOver}\n            >\n              {this.getBodyRows().map(renderBodyRows, this)}\n            </tbody>\n          </table>\n        </div>\n      </div>\n    );\n  }\n}\n\nReactAgenda.propTypes = {\n  minDate: PropTypes.instanceOf(Date),\n  maxDate: PropTypes.instanceOf(Date),\n  startDate: PropTypes.instanceOf(Date),\n  startAtTime: PropTypes.number,\n  endAtTime: PropTypes.number,\n  cellHeight: PropTypes.number,\n  view: PropTypes.string,\n  locale: PropTypes.string,\n  items: PropTypes.array,\n  helper: PropTypes.bool,\n  itemComponent: PropTypes.element,\n  numberOfDays: PropTypes.number,\n  headFormat: PropTypes.string,\n  rowsPerHour: PropTypes.number,\n  itemColors: PropTypes.object,\n  fixedHeader: PropTypes.bool,\n  autoScaleNumber: PropTypes.bool,\n};\n\nReactAgenda.defaultProps = {\n  minDate: new Date(),\n  maxDate: new Date(new Date().getFullYear(), new Date().getMonth() + 3),\n  startDate: new Date(),\n  startAtTime: 0,\n  endAtTime: 0,\n  cellHeight: 15,\n  view: \"agenda\",\n  locale: \"en\",\n  helper: true,\n  items: [],\n  autoScale: false,\n  itemComponent: ReactAgendaItem,\n  numberOfDays: 4,\n  headFormat: \"ddd DD MMM\",\n  rowsPerHour: 4,\n  itemColors: {\n    \"color-1\": \"rgba(102, 195, 131 , 1)\",\n    \"color-2\": \"rgba(242, 177, 52, 1)\",\n    \"color-3\": \"rgba(235, 85, 59, 1)\",\n    \"color-4\": \"rgba(70, 159, 213, 1)\",\n  },\n  fixedHeader: true,\n};\n","// @flow\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport {guid , getUnique , getLast , getFirst } from './helpers.js';\nimport Rdate from 'react-datetime';\nimport './reactAgendaCtrl.css';\n\nvar now = new Date();\n\n\nexport default class ReactAgendaCtrl extends Component {\n  constructor() {\n    super();\n    this.state = {\n      editMode: false,\n      showCtrl: false,\n      multiple: {},\n      name: '',\n      classes: 'priority-1',\n      startDateTime: now,\n      endDateTime: now\n    }\n    this.handleDateChange = this.handleDateChange.bind(this)\n    this.addEvent = this.addEvent.bind(this)\n    this.updateEvent = this.updateEvent.bind(this)\n    this.dispatchEvent = this.dispatchEvent.bind(this)\n    this.handleSubmit = this.handleSubmit.bind(this)\n    this.handleEdit = this.handleEdit.bind(this)\n  }\n\n  componentDidMount() {\n\n  if (this.props.itemColors) {\n    this.setState({\n      classes: Object.keys(this.props.itemColors)[0]\n    })\n\n  }\n  setTimeout(function() {\n    if(this.refs.eventName){\n        this.refs.eventName.focus()\n    }\n\n  }.bind(this), 50);\n\n  if (!this.props.selectedCells) {\n    let start = now\n    let endT = moment(now).add(15, 'Minutes');\n    return this.setState({editMode: false, name: '', startDateTime: start, endDateTime: endT});\n  }\n\n  if (this.props.selectedCells && this.props.selectedCells[0] && this.props.selectedCells[0]._id) {\n\n    let start = moment(this.props.selectedCells[0].startDateTime);\n    let endT = moment(this.props.selectedCells[0].endDateTime);\n\n    return this.setState({editMode: true, name: this.props.selectedCells[0].name, classes: this.props.selectedCells[0].classes, startDateTime: start, endDateTime: endT});\n\n  }\n\n  if (this.props.selectedCells && this.props.selectedCells.length === 1) {\n    let start = moment(getFirst(this.props.selectedCells));\n    let endT = moment(getLast(this.props.selectedCells)).add(15, 'Minutes');\n    return this.setState({editMode: false, name: '', startDateTime: start, endDateTime: endT});\n  }\n\n  if (this.props.selectedCells && this.props.selectedCells.length > 0) {\n    let start = moment(getFirst(this.props.selectedCells));\n    let endT = moment(getLast(this.props.selectedCells)) || now;\n    this.setState({editMode: false, name: '', startDateTime: start, endDateTime: endT});\n  }\n\n}\n\n  handleChange(event) {\n    if(event.target.tagName === 'BUTTON'){\n      event.preventDefault();\n    }\n\n    var data = this.state;\n    data[event.target.name] = event.target.value;\n\n    this.setState(data);\n  }\n\n  handleDateChange(ev, date) {\n    var endD = moment(this.state.endDateTime)\n  var data = this.state;\n  data[ev] = date;\n\n  if(ev === 'startDateTime' && endD.diff(date)< 0 ){\n    data['endDateTime'] = moment(date).add(15 , 'minutes');\n  }\n\n  this.setState(data);\n\n  }\n\n\ndispatchEvent(obj) {\n  var newAdded = []\n  var items = this.props.items;\n  if (obj['multiple']) {\n    var array = obj['multiple']\n    Object.keys(array).forEach(function(key) {\n      var newAr = array[key].filter(function(val, ind) {\n        return array[key].indexOf(val) == ind;\n      })\n      var start = newAr[0];\n      var endT = newAr[newAr.length - 1] || now;\n      var lasobj = {\n        _id: guid(),\n        name: obj.name,\n        startDateTime: new Date(start),\n        endDateTime: new Date(endT),\n        classes: obj.classes\n      }\n      items.push(lasobj)\n      newAdded.push(lasobj)\n    }.bind(this));\n    return this.props.Addnew(items, newAdded)\n  }\n\n  obj._id = guid();\n  items.push(obj)\n  this.props.Addnew(items, obj)\n}\n\naddEvent(e) {\n  if (this.state.name.length < 1) {\n    return;\n  }\n\n  if(this.props.selectedCells && this.props.selectedCells.length > 0){\n\n    var obj = this.props.selectedCells.reduce((r, v, i, a, k = v.substring(0, 10)) => ((r[k] = r[k] || []).push(v), r), {});\n\n    if (Object.values(obj).length > 1) {\n      var newObj = {\n        name: this.state.name,\n        startDateTime: new Date(this.state.startDateTime),\n        endDateTime: new Date(this.state.endDateTime),\n        classes: this.state.classes,\n        multiple: obj\n      }\n\n      return this.dispatchEvent(newObj);\n\n    }\n\n  }\n\n  var newObj = {\n    name: this.state.name,\n    startDateTime: new Date(this.state.startDateTime),\n    endDateTime: new Date(this.state.endDateTime),\n    classes: this.state.classes\n  }\n\n  this.dispatchEvent(newObj);\n}\n\nupdateEvent(e) {\n  if (this.props.selectedCells[0]._id && this.props.items) {\n\n    var newObj = {\n      _id: this.props.selectedCells[0]._id,\n      name: this.state.name,\n      startDateTime: new Date(this.state.startDateTime),\n      endDateTime: new Date(this.state.endDateTime),\n      classes: this.state.classes\n    }\n    var items = this.props.items\n    for (var i = 0; i < items.length; i++) {\n      if (items[i]._id === newObj._id)\n        items[i] = newObj;\n      }\n    if (this.props.edit) {\n      this.props.edit(items, newObj);\n    }\n\n  }\n\n}\n\n\nhandleSubmit(e) {\n  e.preventDefault();\n  this.addEvent(e);\n}\n\nhandleEdit(e) {\n  e.preventDefault();\n  this.updateEvent(e);\n}\n\nrender() {\n  var itc = Object.keys(this.props.itemColors)\n  var colors = itc.map(function(item, idx) {\n\n    return <div style={{\n      background: this.props.itemColors[item]\n    }} className=\"agendCtrls-radio-buttons\" key={item}>\n      <button name=\"classes\"  value={item} className={this.state.classes === item?'agendCtrls-radio-button--checked':'agendCtrls-radio-button'} onClick={this.handleChange.bind(this)}/>\n    </div>\n  }.bind(this))\n\n  const divStyle = {};\n\n  if (this.state.editMode) {\n\n    var select = this.props.selectedCells[0];\n\n    return (\n      <div className=\"agendCtrls-wrapper\" style={divStyle}>\n        <form onSubmit={this.handleEdit}>\n          <div className=\"agendCtrls-label-wrapper\">\n            <div className=\"agendCtrls-label-inline\">\n              <label>Event name</label>\n              <input type=\"text\" name=\"name\" autoFocus ref=\"eventName\" className=\"agendCtrls-event-input\" value={this.state.name} onChange={this.handleChange.bind(this)} placeholder=\"Event Name\"/>\n            </div>\n            <div className=\"agendCtrls-label-inline \">\n              <label>Color</label>\n              <div className=\"agendCtrls-radio-wrapper\">\n                {colors}</div>\n            </div>\n          </div>\n          <div className=\"agendCtrls-timePicker-wrapper\">\n            <div className=\"agendCtrls-time-picker\">\n              <label >Start Date</label>\n              <Rdate value={this.state.startDateTime} onChange={this.handleDateChange.bind(null, 'startDateTime')} input={false} viewMode=\"time\" ></Rdate>\n            </div>\n            <div className=\"agendCtrls-time-picker\">\n              <label >End Date</label>\n              <Rdate value={this.state.endDateTime} onChange={this.handleDateChange.bind(null, 'endDateTime')} input={false} viewMode=\"time\" ></Rdate>\n            </div>\n          </div>\n\n          <input type=\"submit\" value=\"Save\"/>\n        </form>\n      </div>\n    );\n\n  }\n\n  return (\n    <div className=\"agendCtrls-wrapper\" style={divStyle}>\n      <form onSubmit={this.handleSubmit}>\n        <div className=\"agendCtrls-label-wrapper\">\n          <div className=\"agendCtrls-label-inline\">\n            <label>Event name</label>\n            <input type=\"text\" ref=\"eventName\" autoFocus name=\"name\" className=\"agendCtrls-event-input\" value={this.state.name} onChange={this.handleChange.bind(this)} placeholder=\"Event Name\"/>\n          </div>\n          <div className=\"agendCtrls-label-inline\">\n            <label>Color</label>\n            <div className=\"agendCtrls-radio-wrapper\">\n              {colors}</div>\n          </div>\n        </div>\n        <div className=\"agendCtrls-timePicker-wrapper\">\n          <div className=\"agendCtrls-time-picker\">\n            <label >Start Date</label>\n            <Rdate value={this.state.startDateTime} onChange={this.handleDateChange.bind(null, 'startDateTime')} input={false} viewMode=\"time\" ></Rdate>\n          </div>\n          <div className=\"agendCtrls-time-picker\">\n            <label >End Date</label>\n            <Rdate value={this.state.endDateTime} onChange={this.handleDateChange.bind(null, 'endDateTime')} input={false} viewMode=\"time\" ></Rdate>\n          </div>\n        </div>\n\n        <input type=\"submit\" value=\"Save\"/>\n      </form>\n    </div>\n  );\n}\n}\n\n\nReactAgendaCtrl.propTypes = {\n  items: PropTypes.array,\n  itemColors: PropTypes.object,\n  selectedCells: PropTypes.array,\n  edit: PropTypes.func,\n  Addnew: PropTypes.func\n\n};\n\nReactAgendaCtrl.defaultProps = {\n  items: [],\n  itemColors: {},\n  selectedCells: []\n  }\n","import React, {Component} from 'react';\nimport ReactDOM from 'react-dom';\nimport PropTypes from 'prop-types';\n\nclass ModalView extends Component {\n  render() {\n    if(this.props.frameless){\n      return <div className=\"modal-nude  box-card\">\n              <a onClick={this.props.closeFunc} className=\"modal-close\">X</a>\n                <div className=\"modal-title\"> {this.props.title}</div>\n         {this.props.children}\n        </div>\n    }\n\n    return <div className=\"modal  box-card\">\n      <a onClick={this.props.closeFunc} className=\"modal-close\">X</a>\n              <div className=\"modal-title\"> {this.props.title}</div>\n       {this.props.children}\n      </div>\n  }\n}\n\nModalView.propTypes = {\n  title: PropTypes.string,\n  frameless: PropTypes.bool,\n  children: PropTypes.element,\n  closeFunc: PropTypes.func,\n\n};\n\nModalView.defaultProps = {\n  title: '',\n  frameless: false\n}\n\nexport default class Modal extends Component {\n\nconstructor(props){\n  super(props);\n  this.clickedOutside = this.clickedOutside.bind(this)\n  this.closeFunc = this.closeFunc.bind(this)\n\n}\n\n  componentDidMount(){\n  this.modalWrapperTarget = document.createElement('div')\n\n  this.modalWrapperTarget.className= \"modal-wrapper\";\n\n  this.modalWrapperTarget.addEventListener('click' , this.clickedOutside);\n  this.modalWrapperTarget.addEventListener('click' , this.clickedOutside);\n  this.modalWrapperTarget.addEventListener('keydown', this.clickedOutside, true);\n\n  document.body.appendChild(this.modalWrapperTarget)\n  this._render();\n  }\n\n\nclickedOutside(e){\n\n  if((e.key=='Escape'||e.key=='Esc'||e.keyCode==27)){\n      e.preventDefault();\n      this.props.clickOutside(e)\n      return false;\n  }\n\n  if(this.props.clickOutside && e.target.classList.contains('modal-wrapper')){\n    this.props.clickOutside(e)\n  }\n\n}\n\ncloseFunc(e){\n  if(this.props.clickOutside ){\n    this.props.clickOutside(e)\n  }\n}\n\n\n  _render(){\n\n    ReactDOM.render( <ModalView children={this.props.children} closeFunc={this.closeFunc} title={this.props.title} frameless={this.props.frameless}/>\n                      , this.modalWrapperTarget )\n  }\n\n\ncomponentDidUpdate(){\n  this._render()\n}\n\n  componentWillUnmount(){\n\n   this.modalWrapperTarget.removeEventListener('click' , this.clickedOutside);\n   this.modalWrapperTarget.removeEventListener('keydown' , this.clickedOutside);\n    ReactDOM.unmountComponentAtNode(this.modalWrapperTarget);\n    document.body.removeChild(this.modalWrapperTarget);\n  }\n\n  render() {\n    return <noscript/>\n  }\n}\n\nModal.propTypes = {\n  title: PropTypes.string,\n  frameless: PropTypes.bool,\n  children: PropTypes.element,\n  closeFunc: PropTypes.func,\n\n};\n\nModal.defaultProps = {\n  title: '',\n  frameless: false\n}\n","import ReactAgenda from './reactAgenda.js';\nimport ReactAgendaCtrl from './reactAgendaCtrl.js';\nimport Modal from './Modal/Modal.js';\nimport {guid , getUnique , getLast , getFirst } from './helpers.js';\n//import './style.css';\nimport './reactAgenda.css';\nimport './Modal/Modal.css';\nmodule.exports = { ReactAgenda , ReactAgendaCtrl , guid , getUnique , getLast , getFirst , Modal } ;\n"],"names":["getUnique","array","newAr","filter","val","ind","indexOf","getLast","length","getFirst","guid","s4","Math","floor","random","toString","substring","mapItems","itemsArray","rowsPerHour","timezone","itemsMap","sort","a","b","startDateTime","forEach","item","interval","offsetMinutes","getMinutes","start","moment","subtract","toDate","end","endDateTime","duration","diff","rows","ceil","asHours","cellRefs","i","ref","add","format","push","newItem","Object","keys","key","includes","reduce","obj","classes","_id","newArr","ReactAgendaItem","props","state","wrapper","width","marginLeft","zIndex","borderLeft","controls","updateDimensions","bind","raiseZindex","lowerZindex","elem","document","getElementById","parent","nwidh","offsetWidth","nmrgl","padder","setState","marginTop","componentWillReceiveProps","next","setTimeout","componentDidMount","window","addEventListener","componentWillUnmount","removeEventListener","e","sty","newState","assign","render","duratH","_milliseconds","humanize","duratL","duratE","React","edit","remove","name","Component","propTypes","PropTypes","string","object","number","func","defaultProps","DragDropTouch","DragDropTouch_1","DataTransfer","_dropEffect","_effectAllowed","_data","defineProperty","prototype","get","set","value","enumerable","configurable","clearData","type","getData","setData","setDragImage","img","offsetX","offsetY","ddt","_instance","_imgCustom","_imgOffset","x","y","_lastClick","d","ts","_touchstart","tm","_touchmove","te","_touchend","getInstance","_this","_shouldHandle","Date","now","_DBLCLICK","_dispatchEvent","target","preventDefault","_reset","src","_closestDraggable","_dragSource","_ptDown","_getPoint","_lastTouch","_img","_CTXMENU","_getTarget","delta","_getDelta","_THRESHOLD","_createImage","_lastTarget","_moveImage","_destroyImage","defaultPrevented","touches","_dataTransfer","page","pageX","clientX","pageY","clientY","p","abs","pt","el","elementFromPoint","getComputedStyle","pointerEvents","parentElement","cloneNode","_copyStyle","style","top","left","rc","getBoundingClientRect","opacity","_OPACITY","body","appendChild","removeChild","requestAnimationFrame","s","position","_copyProps","dst","_rmvAtts","att","removeAttribute","HTMLCanvasElement","cSrc","cDst","height","getContext","drawImage","cs","children","evt","createEvent","t","initEvent","button","which","buttons","_kbdProps","_ptProps","dataTransfer","dispatchEvent","hasAttribute","split","startSelect","endSelect","isDragging","draggedElement","timeNow","ctrlKey","DEFAULT_ITEM","mouse","startX","startY","element","helper","ReactAgenda","date","items","itemOverlayStyles","highlightedCells","numberOfDays","autoScaleNumber","focusedCell","handleBeforeUpdate","handleOnNextButtonClick","handleOnPrevButtonClick","handleMouseClick","handleMouseOver","removeSelection","handleAllClickStarts","handleAllClickEnds","onDragStart","onDragEnter","onDragOver","onDragEnd","onDragHandlerStart","onDragHandlerEnd","getSelection","editEvent","removeEvent","dragEvent","duplicateEvent","resizeEvent","componentWillMount","autoScale","locale","round","getHeaderColumns","cols","getBodyRows","startAtTime","endAtTime","hours","minutes","seconds","milliseconds","getMinuteCells","rowMoment","cells","cellRef","hasOwnProperty","startDate","minDate","maxDate","nextStartDate","min","newStart","newEnd","onDateRangeChange","startOf","endOf","prevStartDate","max","cell","bypass","tagName","dt","innerText","old","parseInt","newdate","getFullYear","getMonth","getDate","mom","toISOString","onCellSelect","setMousePosition","ev","event","returnValue","classList","contains","strt","endd","id","innerHTML","getElementsByClassName","n","isMouseDown","toggle","createElement","className","old2","dropEffect","effectAllowed","stopPropagation","parentNode","onChangeEvent","itm","refs","newEnddate","onChangeDuration","difference","getHours","newDate","draggedItem","undefined","offsetParent","arr","onRangeSelection","onItemEdit","newItems","onItemRemove","renderHeaderColumns","col","headerLabel","headFormat","renderBodyRows","row","timeLabel","differ","map","renderMinuteCells","Colors","itemColors","ItemComponent","itemComponent","renderItemCells","cellClasses","agenda__cell","classSet","classNames","splt","nwsplt","styles","cellHeight","splice","join","background","itemElement","idx","last1","first1","last","first","disablePrev","getTime","disableNext","view","instanceOf","bool","fixedHeader","ReactAgendaCtrl","editMode","showCtrl","multiple","handleDateChange","addEvent","updateEvent","handleSubmit","handleEdit","eventName","focus","selectedCells","endT","handleChange","data","endD","newAdded","lasobj","Addnew","r","v","k","values","newObj","itc","colors","divStyle","ModalView","frameless","closeFunc","title","Modal","clickedOutside","modalWrapperTarget","_render","keyCode","clickOutside","ReactDOM","componentDidUpdate","unmountComponentAtNode","module","exports"],"mappings":"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"}